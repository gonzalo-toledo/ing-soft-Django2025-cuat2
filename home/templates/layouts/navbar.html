{% load static %}
{% load i18n %}
<nav class="navbar navbar-expand-lg px-4 navbar-dark">
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav me-auto">
      <li class="nav-item">
        <a class="nav-link fw-bold" href="{% url 'index' %}">SkyWay</a>
      </li>
      {% if user.is_authenticated %}
        <li class="nav-item">
          <a class="nav-link" href="{% url 'reserva_list' %}">{% trans "Mis reservas" %}</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'boleto_list' %}">{% trans "Mis boletos" %}</a>
        </li>
      {% endif %}
      <li class="nav-item">
        <a class="nav-link" href="{% url 'vuelo_list' %}">{% trans "Vuelos" %}</a>
      </li>
      {% if user.is_staff %}
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle text-warning fw-bold" href="#" id="staffDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="bi bi-shield-check"></i> {% trans "Panel Staff" %}
          </a>
          <ul class="dropdown-menu" aria-labelledby="staffDropdown">
            <li><a class="dropdown-item" href="{% url 'vuelos_pasajeros_staff' %}">
              <i class="bi bi-people"></i> {% trans "Pasajeros por Vuelo" %}
            </a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="/admin/">
              <i class="bi bi-gear"></i> {% trans "Administración" %}
            </a></li>
          </ul>
        </li>
      {% endif %}
    </ul>

    <ul class="navbar-nav ms-auto align-items-center">

      <!-- Botones para cambiar idioma -->
      <li class="nav-item me-2">
        <form action="{% url 'set_language' %}" method="post" style="display:inline;">
          {% csrf_token %}
          <input name="language" type="hidden" value="es">
          <input name="next" type="hidden" value="{{ request.get_full_path }}">
          <button type="submit" class="btn btn-sm btn-outline-light {% if LANGUAGE_CODE == 'es' %}active{% endif %}">ES</button>
        </form>
      </li>
      <li class="nav-item">
        <form action="{% url 'set_language' %}" method="post" style="display:inline;">
          {% csrf_token %}
          <input name="language" type="hidden" value="en">
          <input name="next" type="hidden" value="{{ request.get_full_path }}">
          <button type="submit" class="btn btn-sm btn-outline-light {% if LANGUAGE_CODE == 'en' %}active{% endif %}">EN</button>
        </form>
      </li>

      {% if user.is_authenticated %}
        <li class="nav-item">
          <span class="navbar-text text-light ms-3 me-3">
            <i class="bi bi-person-circle"></i> {{ user.username }}
            {% if user.is_staff %}<span class="badge bg-warning text-dark ms-1">Staff</span>{% endif %}
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link text-danger fw-bold" href="{% url 'logout' %}">{% trans "Cerrar sesión" %}</a>
        </li>
      {% else %}
        <li class="nav-item">
          <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#loginModal">{% trans "Iniciar sesión" %}</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#registerModal">{% trans "Registrate" %}</a>
        </li>
      {% endif %}
    </ul>
  </div>

  <div>
    {% include 'account/login_modal.html' %}
    {% include 'account/register_modal.html' %}
  </div>
</nav>
